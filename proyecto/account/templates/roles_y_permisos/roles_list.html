{% load static %}

<html lang="en">
<head>
    <title>Listar roles </title>
    <link rel="stylesheet" type="text/css" href="{% static "css/base.css" %}" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
</head>
<body style="overflow: overlay;">
    <div id="header">
        <a href="{% url "tablero" %}"><span class="logo" style="color:#df8a3d; margin-left:-5%">Gestor de Proyectos</span></a>
        {% if request.user.is_authenticated %}
          <ul class="menu">
              <li>
              <a href="{% url "list-projects" %}">Proyectos</a>
              </li>
              <li>
              <a href="{% url "tipos_us-list" project.id %}">Tipo US</a></a>
              </li>
              <li>
              <a href="{% url "sprint-list" project.id %}">Sprints</a>
              </li>
               <li>
              <a href="{% url "user_story-list" project.id %}">Product Backlog</a>
              </li>
               <li>
              <a href="{% url "list-roles" project.id %}">Roles</a>
              </li>
          </ul>
          {% endif %}
          <span class="user">
              {% if request.user.is_authenticated %}
              Hola, {{ request.user.first_name }}..
              <a style="color:#df8a3d" href="{% url "logout" %}">Cerrar Sesión</a>
              {% else %}
              <a href="{% url "login" %}">Iniciar Sesión</a>
              {% endif %}
          </span>
    </div>




 <p class="display-3" style="margin-left:550px;">
  {% if 45 in out or request.user.is_superuser %}
  <a class="button-create" href="{% url "add-rol" project.id %}">Agregar Rol</a></p>
 {% endif %}
    <div>
        <script>
            document.addEventListener("DOMContentLoaded", () => {
              const rows = document.querySelectorAll("tr[data-href]");
              rows.forEach( row => {
                row.addEventListener("click", () =>{
                  window.location.href = row.dataset.href;
                });
              });
            });
        </script>
        <table class="table table-striped table-hover" border="5px solid #000;" style="margin-top:30px;">
                <thead class="thead-dark">
                    <tr>
                        <th>Id</th>
                        <th>Rol</th>
                        <th>Descripción</th>
                        <th>Permisos</th>
                        <th>Proyecto</th>
                        <th>Edit</th>
                        <th>Delete</th>
                    </tr>
                </thead>
                
                {% for i in roles_list %}
                {% if project == i.proyecto %}
                <tr>
                    <td style="padding:10px;">{{i.id}}</td>
                    <td style="padding:10px;">{{i.rol}}</td>
                    <td style="padding:10px;">{{i.desc_rol}}</td>
                    <td>  {% for permisos in i.permisos.all %}
                        {% if 'content type' not in permisos.name and 'association' not in permisos.name and 'code' not in permisos.name and 'nonce' not in permisos.name and 'user social auth' not in permisos.name and 'partial' not in permisos.name and 'kanban' not in permisos.name and 'reportes' not in permisos.name and 'group' not in permisos.name and 'backlog' not in permisos.name and 'group' not in permisos.name and 'log entry' not in permisos.name and 'content type' not in permisos.name and 'profile' not in permisos.name and 'usuarios' not in permisos.name and 'session' not in permisos.name %}
                            <li style="padding:10px;">{{permisos}}</li>
                         {% endif %}
                    {% endfor %}</td>
                    <td style="padding:10px;">{{i.proyecto}}</td>
                    {% if 46 in out or request.user.is_superuser %}
                    <td style="padding:10px;"><a href="{% url 'update-rol' i.pk project.id %}">Edit</a></td>
                    {% endif %}
                    {% if 46 in out or request.user.is_superuser %}
                    <td style="padding:10px;"><a href="{% url 'delete-rol' i.pk project.id %}">Delete</a></td>
                    {% endif %}
                </tr>
                {% endif %}
                {% endfor %}
        </table>
    </div>
</body>
</html>

 
