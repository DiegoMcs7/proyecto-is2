{% extends "base.html" %}

{% block title %} Tabla Proyecto {% endblock %}

{% block content %}

<body>
  <h2 style="text-align: center; padding-bottom: 15px;">Proyectos</h2>
{% if 'Can add proyectos' in out or request.user.is_superuser %}
 <p class="display-3">
    <a class="button-create" href="{% url "add-project" %}">
        <i class="bi bi-plus text-primary"></i> Agregar</a></p>
{% endif %}
    <div>
        <script>
            document.addEventListener("DOMContentLoaded", () => {
              const rows = document.querySelectorAll("tr[data-href]");
              rows.forEach( row => {
                row.addEventListener("click", () =>{
                  window.location.href = row.dataset.href;
                });
              });
            });
        </script>
        
        <table class="table table-striped table-hover" border="5px solid #000;" style="margin-top:30px;">
                <thead class="thead-dark">
                    <tr>
                        <th>Id</th>
                        <th>Nombre</th>
                        <th>Descripci√≥n</th>
                        <th>Estado de Proyecto</th>
                        <th>Fecha Inicio</th>
                        <th>Fecha Fin</th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                    </tr>
                </thead>
                  {% for i in project_list %}
                  {% if not request.user.is_superuser %}
                  {% for member in members %}
                  {% if member.id_proyecto_id == i.id and user == member.id_usuario_id%}
                  <tr scope="row" data-href="{% url 'add-members' i.pk %}" style="tr:hover {background-color: #77bdff;}">
                      <td style="padding:10px;">{{i.id}} </a></td>
                      <td style="padding:10px;">{{i.nombre_proyecto}}</td>
                      <td style="padding:10px;">{{i.desc_proyecto}}</td>
                      <td style="padding:10px;">{{i.estado_proyecto}}</td>
                      <td style="padding:10px;">{{i.fecha_inicio}}</td>
                      <td style="padding:10px;">{{i.fecha_fin}}</td>  
                      <td class="btn-group" role="group" aria-label="Basic mixed styles example">
                        {% if 14 in out or request.user.is_superuser %}
                        <button type="button" class="btn btn-warning" ><a href="{% url 'update-project' i.pk %}"  style="color:#ffff; margin-left:-7%; margin-top:7px; text-decoration: none;" >Editar</a></button>
                        <button type="button" class="btn btn-success" ><a href="{% url 'inicializar_proyecto' i.pk %}"style="color:#ffff; margin-left:-7%; margin-top:7px; text-decoration: none;" >Inicializar</a></button>
                        {% endif %}
                        {% if request.user.is_superuser %}
                        <button type="button" class="btn btn-danger" ><a href="{% url 'finalizar_proyecto' i.pk %}"style="color:#ffff; margin-left:-7%; margin-top:7px; text-decoration: none;">Finalizar</a></button>
                        {% endif %}
                        {% if request.user.is_superuser %}
                        <button type="button" class="btn btn-danger" ><a href="{% url 'delete-project' i.pk %}"style="color:#ffff; margin-left:-7%; margin-top:7px; text-decoration: none;">Eliminar</a></button>
                        {% endif %}
                      </td>

                  </tr>
                  {% endif %}
                {% endfor %}
                {% else %}
                <tr scope="row" data-href="{% url 'add-members' i.pk %}" style="tr:hover {background-color: #77bdff;}">
                      <td style="padding:10px;">{{i.id}} </a></td>
                      <td style="padding:10px;">{{i.nombre_proyecto}}</td>
                      <td style="padding:10px;">{{i.desc_proyecto}}</td>
                      <td style="padding:10px;">{{i.estado_proyecto}}</td>
                      <td style="padding:10px;">{{i.fecha_inicio}}</td>
                      <td style="padding:10px;">{{i.fecha_fin}}</td>
                      <td class="btn-group" role="group" aria-label="Basic mixed styles example">
                        {% if 14 in out or request.user.is_superuser %}
                        <button type="button" class="btn btn-warning" ><a href="{% url 'update-project' i.pk %}"  style="color:#ffff; margin-left:-7%; margin-top:7px; text-decoration: none;" >Editar</a></button>
                        <button type="button" class="btn btn-success" ><a href="{% url 'inicializar_proyecto' i.pk %}"style="color:#ffff; margin-left:-7%; margin-top:7px; text-decoration: none;" >Inicializar</a></button>
                        {% endif %}
                        {% if request.user.is_superuser %}
                        <button type="button" class="btn btn-danger" ><a href="{% url 'finalizar_proyecto' i.pk %}"style="color:#ffff; margin-left:-7%; margin-top:7px; text-decoration: none;">Finalizar</a></button>
                        {% endif %}
                        {% if request.user.is_superuser %}
                        <button type="button" class="btn btn-danger" ><a href="{% url 'delete-project' i.pk %}"style="color:black; margin-left:-7%; margin-top:7px; text-decoration: none;">Eliminar</a></button>
                        {% endif %}
                      </td>
                </tr>
                {% endif %}
                {% endfor %}
        </table>

    </div>
 
</body>
 
{% endblock %}